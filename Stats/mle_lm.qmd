---
title: "Maximum Likelihood Estimation - Linear Regression"
description: |
    Illustrated using Julia
date: "2022-12-9"
format:
  html:
    code-fold: false
execute:
  freeze: true
jupyter: julia-1.9
---

An example of estimating regression coefficients in a linear model via maximum likelihood, using Julia.

```{julia}
using Distributions
using Random
using Optim
using GLM
```

Generate some fake data

```{julia}
Random.seed!(0408)

#x data
ğ— = hcat(ones(1000), randn(1000, 3))

#ground truth betas
ğš© = [0.5, 1, 2, 3]

#multiply data by betas
fâ‚(X) = X * ğš©

#make some error
Ïµ = rand(Normal(0, 0.5), size(ğ—)[1])

#generate y
y = fâ‚(ğ—) + Ïµ;
``` 

Define a function to optimize

```{julia}
function mle_lm(x, y, params)
    b = params[begin:end-1]
    Ïƒ = params[end]

    yÌ‚ = x * b

    residuals = y .- yÌ‚

    ll = -loglikelihood(Normal(0, Ïƒ), residuals)

    return ll
end
```

Run the optimization

```{julia}
start_params = [0.2, 0.5, 1, 1, 1]

res = optimize(params -> mle_lm(ğ—, y, params), start_params)

Optim.minimizer(res)
```


Check against 'base' Julia solution
```{julia}
ğ— \ y
```
