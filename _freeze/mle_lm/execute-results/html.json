{
  "hash": "2771006ef0c0251b30a29aab478b2706",
  "result": {
    "markdown": "---\ntitle: Maximum Likelihood Estimation - Linear Regression\ndescription: |\n  Illustrated using Julia\ndate: 2022-12-9\nformat:\n  html:\n    code-fold: false\n---\n\nAn example of estimating regression coefficients in a linear model via maximum likelihood, using Julia.\n\n::: {.cell execution_count=1}\n``` {.julia .cell-code}\nusing Distributions\nusing Random\nusing Optim\nusing GLM\n```\n:::\n\n\nGenerate some fake data\n\n::: {.cell execution_count=2}\n``` {.julia .cell-code}\nRandom.seed!(0408)\n\n#x data\nùêó = hcat(ones(1000), randn(1000, 3))\n\n#ground truth betas\nùö© = [.5, 1, 2, 3]\n\n#multiply data by betas\nf‚ÇÅ(X) = X*ùö©\n\n#make some error\nœµ = rand(Normal(0, .5), size(ùêó)[1])\n\n#generate y\ny = f‚ÇÅ(ùêó) + œµ;\n```\n:::\n\n\nDefine a function to optimize\n\n::: {.cell execution_count=3}\n``` {.julia .cell-code}\nfunction mle_lm(x, y, params)\n    b = params[begin:end-1]\n    œÉ = params[end]\n\n    yÃÇ = x*b\n\n    residuals = y .- yÃÇ\n\n    ll = -loglikelihood(Normal(0, œÉ), residuals)\n\n    return ll\nend\n```\n\n::: {.cell-output .cell-output-display execution_count=4}\n```\nmle_lm (generic function with 1 method)\n```\n:::\n:::\n\n\nRun the optimization\n\n::: {.cell execution_count=4}\n``` {.julia .cell-code}\nstart_params = [0.2, .5, 1, 1, 1]\n\nres = optimize(params -> mle_lm(ùêó, y, params), start_params)\n\nOptim.minimizer(res)\n```\n\n::: {.cell-output .cell-output-display execution_count=5}\n```\n5-element Vector{Float64}:\n 0.5220526008168841\n 0.9925044101015756\n 1.9951661029827337\n 2.9979617225853903\n 0.5170359122024899\n```\n:::\n:::\n\n\nCheck against 'base' Julia solution\n\n::: {.cell execution_count=5}\n``` {.julia .cell-code}\nùêó \\ y\n```\n\n::: {.cell-output .cell-output-display execution_count=6}\n```\n4-element Vector{Float64}:\n 0.5220524130050495\n 0.9925035386795747\n 1.9951668631756507\n 2.9979619869409357\n```\n:::\n:::\n\n\n",
    "supporting": [
      "mle_lm_files\\figure-html"
    ],
    "filters": [],
    "includes": {}
  }
}